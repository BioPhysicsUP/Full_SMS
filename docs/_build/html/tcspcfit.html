
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>tcspcfit &#8212; UP Biophysics SMS Analysis 0.1 documentation</title>
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="module-tcspcfit">
<span id="tcspcfit"></span><h1>tcspcfit<a class="headerlink" href="#module-tcspcfit" title="Permalink to this headline">¶</a></h1>
<p>Module for fitting TCSPC data.</p>
<p>The function distfluofit is based on MATLAB code by Jörg Enderlein:
<a class="reference external" href="https://www.uni-goettingen.de/en/513325.html">https://www.uni-goettingen.de/en/513325.html</a></p>
<p>Bertus van Heerden
University of Pretoria</p>
<dl class="class">
<dt id="tcspcfit.FluoFit">
<em class="property">class </em><code class="descclassname">tcspcfit.</code><code class="descname">FluoFit</code><span class="sig-paren">(</span><em>irf</em>, <em>measured</em>, <em>t</em>, <em>channelwidth</em>, <em>tau=None</em>, <em>amp=None</em>, <em>shift=None</em>, <em>bg=None</em>, <em>irfbg=None</em>, <em>startpoint=None</em>, <em>endpoint=None</em>, <em>ploton=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tcspcfit.html#FluoFit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tcspcfit.FluoFit" title="Permalink to this definition">¶</a></dt>
<dd><p>Base class for fit of a multi-exponential decay curve.</p>
<p>This class is only used for subclassing.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>irf</strong> (<em>ndarray</em>) – Instrumental Response Function</li>
<li><strong>measured</strong> (<em>ndarray</em>) – The measured decay data</li>
<li><strong>channelwidth</strong> (<em>float</em>) – Time width of one TCSPC channel (in nanoseconds)</li>
<li><strong>tau</strong> (<em>array_like</em><em>, </em><em>optional</em>) – Initial guess times (in ns). This is either in the format
[tau1, tau2, …] or [[tau1, min1, max1, fix1], [tau2, …], …].
When the “fix” value is False, the min and max values are ignored.</li>
<li><strong>amp</strong> (<em>array_like</em><em>, </em><em>optional</em>) – Initial guess amplitude. Format [amp1, amp2, …] or [[amp1, fix1],
[amp2, fix2], …]</li>
<li><strong>shift</strong> (<em>array_like</em><em>, </em><em>optional</em>) – Initial guess IRF shift. Either a float, or [shift, min, max, fix].</li>
<li><strong>bg</strong> (<em>float</em>) – Background value for decay. Will be estimated if not given.</li>
<li><strong>irfbg</strong> (<em>float</em>) – Background value for IRF. Will be estimated if not given.</li>
<li><strong>startpoint</strong> (<em>int</em>) – Start of fitting range - will default to channel of decay max or
IRF max, whichever is least.</li>
<li><strong>endpoint</strong> (<em>int</em>) – End of fitting range - will default to the channel of the
fluorescence decay that is either around 10 times higher than the
background level or equivalent to 0.1% of the counts in the peak
channel, whichever is greater.</li>
<li><strong>init</strong> (<em>bool  # TODO: add this functionality</em>) – Whether to use an initial guess routine or not.</li>
<li><strong>ploton</strong> (<em>bool</em>) – Whether to automatically plot the irf_data</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="tcspcfit.OneExp">
<em class="property">class </em><code class="descclassname">tcspcfit.</code><code class="descname">OneExp</code><span class="sig-paren">(</span><em>irf</em>, <em>measured</em>, <em>t</em>, <em>channelwidth</em>, <em>tau=None</em>, <em>amp=None</em>, <em>shift=None</em>, <em>bg=None</em>, <em>irfbg=None</em>, <em>startpoint=None</em>, <em>endpoint=None</em>, <em>ploton=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tcspcfit.html#OneExp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tcspcfit.OneExp" title="Permalink to this definition">¶</a></dt>
<dd><p>“Single exponential fit. Takes exact same arguments as Fluofit</p>
</dd></dl>

<dl class="class">
<dt id="tcspcfit.ThreeExp">
<em class="property">class </em><code class="descclassname">tcspcfit.</code><code class="descname">ThreeExp</code><span class="sig-paren">(</span><em>irf</em>, <em>measured</em>, <em>t</em>, <em>channelwidth</em>, <em>tau=None</em>, <em>amp=None</em>, <em>shift=None</em>, <em>bg=None</em>, <em>irfbg=None</em>, <em>startpoint=None</em>, <em>endpoint=None</em>, <em>ploton=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tcspcfit.html#ThreeExp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tcspcfit.ThreeExp" title="Permalink to this definition">¶</a></dt>
<dd><p>“Triple exponential fit. Takes exact same arguments as Fluofit</p>
</dd></dl>

<dl class="class">
<dt id="tcspcfit.TwoExp">
<em class="property">class </em><code class="descclassname">tcspcfit.</code><code class="descname">TwoExp</code><span class="sig-paren">(</span><em>irf</em>, <em>measured</em>, <em>t</em>, <em>channelwidth</em>, <em>tau=None</em>, <em>amp=None</em>, <em>shift=None</em>, <em>bg=None</em>, <em>irfbg=None</em>, <em>startpoint=None</em>, <em>endpoint=None</em>, <em>ploton=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tcspcfit.html#TwoExp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tcspcfit.TwoExp" title="Permalink to this definition">¶</a></dt>
<dd><p>“Double exponential fit. Takes exact same arguments as Fluofit</p>
</dd></dl>

<dl class="function">
<dt id="tcspcfit.colorshift">
<code class="descclassname">tcspcfit.</code><code class="descname">colorshift</code><span class="sig-paren">(</span><em>irf</em>, <em>shift</em>, <em>irflength=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tcspcfit.html#colorshift"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tcspcfit.colorshift" title="Permalink to this definition">¶</a></dt>
<dd><p>Shift irf left or right ‘periodically’.</p>
<p>A shift past the start or end results in those values of irf
‘wrapping around’.</p>
<p>Arguments:
irf – row vector or 1D
shift – float
irflength – float
t – 1D vector</p>
<p>Output:
irs – shifted irf, as row vector</p>
</dd></dl>

<dl class="function">
<dt id="tcspcfit.convol">
<code class="descclassname">tcspcfit.</code><code class="descname">convol</code><span class="sig-paren">(</span><em>irf</em>, <em>decay</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tcspcfit.html#convol"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tcspcfit.convol" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs a convolution of irf with decay.</p>
<p>Periodicity (period = size(decay)) is assumed.</p>
<p>Arguments:
irf – row vector or 1D
decay – 1D or array with irf_data in rows</p>
<p>Output
y – convolution of irf with each row of decay.</p>
</dd></dl>

<dl class="function">
<dt id="tcspcfit.distfluofit">
<code class="descclassname">tcspcfit.</code><code class="descname">distfluofit</code><span class="sig-paren">(</span><em>irf, measured, period, channelwidth, cshift_bounds=[-3, 3], choose=False, ntau=50</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tcspcfit.html#distfluofit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tcspcfit.distfluofit" title="Permalink to this definition">¶</a></dt>
<dd><p>Quickly fit a multiexponential decay to use as ‘initial guess’</p>
<blockquote>
<div>The function aims to identify the number of lifetimes in the
measured irf_data, as well as the values of the lifetimes. The result
can be used as an initial guess for fluofit.</div></blockquote>
<p>Arguments:
irf – Instrumental Response Function measured – Fluorescence decay irf_data
period – Time between laser exciation pulses (in nanoseconds)
channelwidth – Time width of one TCSPC channel (in nanoseconds)
tau – Initial guess times
taubounds – limits for the lifetimes guess times - defaults to 0&lt;tau&lt;100</p>
<blockquote>
<div>format: [[tau1_min, tau1_max], [tau2_min, tau2_max], …]</div></blockquote>
<p>init – Whether to use a initial guess routine or not</p>
<p>Output:
peak_tau    – Decay times of the different decay components
TODO: Add all other outputs
c – Color Shift (time shift of the IRF w.r.t. the fluorescence curve)
offset – Offset
amplitudes – Amplitudes of the different decay components
dc – Color shift error
doffset – Offset error
dtau – Decay times error
irs – IRF, shifted by the value of the colorshift
separated_decays – Fitted fluorecence component curves
t – time axis
chisquared – chi squared value</p>
</dd></dl>

<dl class="function">
<dt id="tcspcfit.makerow">
<code class="descclassname">tcspcfit.</code><code class="descname">makerow</code><span class="sig-paren">(</span><em>vector</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tcspcfit.html#makerow"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tcspcfit.makerow" title="Permalink to this definition">¶</a></dt>
<dd><p>Reshape 1D vector into a 2D row</p>
</dd></dl>

</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">UP Biophysics SMS Analysis</a></h1>








<h3>Navigation</h3>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2019, Bertus van Heerden, Joshua Botha.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.8.5</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/tcspcfit.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>